{% extends "nav.html" %}

{% block content %}
      <div class="container" >
          <div class="row" style="padding-top:60px;">
            <h4>Genereren van het dataformat</h4>
            <p>
                Met deze applicatie kan de data voor het dataformat gegenereerd worden. De data wordt samengesteld op basis van de bestanden die aangeleverd worden. Hierbij is het noodzakelijk dat de geleverde bestanden als Excel-bestand en in de orginele structuur(NoCore) geleverd worden. Het verwerken van de data kan 5 tot 10 minuten of zelfs langer duren.
            </p>
          </div>
          <div class="row" style="padding-top:10px;">
                <form  onSubmit="clickButton(event)" enctype="multipart/form-data" action="/upload" method="post">
                    <div class="col s4">
                        <div class="row">
                            <div class="col s12">
                                <div class="card">
                                <div class="card-content">
                                    <span class="card-title">Medewerker</span>
                                    <p>Upload het Excel-bestand met de gegevens van medewerkers vanuit NoCore. Hieronder staat een voorbeeld tabel met de data van de medewerkers</p>
                                
                                    <table>
                                            <thead>
                                              <tr>
                                                  <th>SollicitantID</th>
                                                  <th>naam</th>
                                                  <th>veld0</th>
                                                  <th>...</th>
                                              </tr>
                                            </thead>
                                    
                                            <tbody>
                                              <tr>
                                                <td>001</td>
                                                <td>J. Wick</td>
                                                <td>Wick</td>
                                                <td>...</td>
                                              </tr>
                                              <tr>
                                                <td>002</td>
                                                <td>T. Hanks</td>
                                                <td>Hanks</td>
                                                <td>...</td>
                                              </tr>
                                              <tr>
                                                <td>003</td>
                                                <td>W. Smith</td>
                                                <td>Smith</td>
                                                <td>...</td>
                                              </tr>
                                            </tbody>
                                          </table>
                               
                                </div>
                                <div class="card-action">
                                    <input  onChange="handleFile()" id="medewerkers"  type="file" name="medewerkers">
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col s4">
                            <div class="col s12">
                                    <div class="card">
                                    <div class="card-content">
                                        <span class="card-title">Projecturen</span>
                                        <p>Upload het Excel-bestand met de gegevens van projecturen vanuit NoCore. Hieronder staat een voorbeeld tabel met de data van de projecturen</p>
                                
                                        <table>
                                                <thead>
                                                  <tr>
                                                      <th>SollicitantID</th>
                                                      <th>cNaam</th>
                                                      <th>JaarWeek</th>
                                                      <th>...</th>
                                                  </tr>
                                                </thead>
                                        
                                                <tbody>
                                                  <tr>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>201906</td>
                                                    <td>...</td>
                                                  </tr>
                                                  <tr>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>201907</td>
                                                    <td>...</td>
                                                  </tr>
                                                  <tr>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>201908</td>
                                                    <td>...</td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                    </div>
                                    <div class="card-action">
                                        <input onChange="handleFile()" id="projecturen" type="file" name="projecturen">
                                    </div>
                                    </div>
                                </div>
                    </div>
    
                    <div class="col s4">
                            <div class="col s12">
                                    <div class="card">
                                    <div class="card-content">
                                        <span class="card-title">Jobs/Projectenlijst</span>
                                        <p>Upload het Excel-bestand met de gegevens van jobs vanuit NoCore. Hieronder staat een voorbeeld tabel met de data van de jobs</p>
                                
                                        <table >
                                                <thead>
                                                  <tr>
                                                      <th>ProjectId</th>
                                                      <th>MedewerkerId</th>
                                                      <th>NaamMedewerker</th>
                                                      <th>...</th>
                                                  </tr>
                                                </thead>
                                        
                                                <tbody>
                                                  <tr>
                                                    <td> </td>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>...</td>
                                                  </tr>
                                                  <tr>
                                                    <td> </td>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>...</td>
                                                  </tr>
                                                  <tr>
                                                    <td> </td>
                                                    <td>001</td>
                                                    <td>J. Wick</td>
                                                    <td>...</td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                    </div>
                                    <div class="card-action">
                                        <input onChange="handleFile()"  id="jobs" type="file" name="jobs">
                                    </div>
                                    </div>
                                </div>
                    </div>
                </div>
                 
                <button id="submitBestanden" class="btn waves-effect waves-light amber darken-2" type="submit" name="action" >Genereer dataformat
                </button>

                <div class="progress orange lighten-5">
                  <div id="progressBar-files" class="determinate orange darken-3" style="width: 0%"></div>
              </div>
        
              
                </form>

                <div id="Loader" hidden>
                    <div class="progress indeterminate amber lighten-5">
                        <div class="indeterminate amber darken-2" style="width: 100%"></div>
                    </div>                  
                </div>
            </div>     


            <script>
            
            function clickButton(e) {
              if
                (
                !document.getElementById("medewerkers").value ||
                !document.getElementById("projecturen").value ||
                !document.getElementById("jobs").value 
                )
              {
                e.preventDefault()
                alert("Geef alle bestanden mee")
              } 
              else
              {
                document.getElementById("Loader").hidden = false
                document.getElementById("submitBestanden").hidden = true
                document.getElementById("submitBestanden").setAttribute("disabled","true")
              }

            }
            
            function handleFile()
            {
              percentage = 0

              if(document.getElementById("medewerkers").value)
              {
                percentage += 33.3333333
              }

              if(document.getElementById("projecturen").value)
              {
                percentage += 33.3333333
              }

              if(document.getElementById("jobs").value)
              {
                percentage += 33.3333333
              }
              
              if(percentage > 98) document.getElementById("submitBestanden").disabled = false;
              if(percentage <= 98) document.getElementById("submitBestanden").disabled = true;

              console.log(percentage)
              document.getElementById("progressBar-files").style = "width:" + String(percentage) + "%;"
              
            }
            </script>
        {% endblock %}